/**
 * TouchSlider v1.2.4
 * By qiqiboy, http://www.qiqiboy.com, http://weibo.com/qiqiboy, 2012/12/05
 */
!function(a){var b="createTouch"in document||"ontouchstart"in a,c=document.createElement("div").style,d=function(){var a,b={OTransform:["-o-","otransitionend"],WebkitTransform:["-webkit-","webkitTransitionEnd"],MozTransform:["-moz-","transitionend"],msTransform:["-ms-","MSTransitionEnd"],transform:["","transitionend"]};for(a in b)if(a in c)return b[a];return!1}(),e=[["width","left","right"],["height","top","bottom"]],f=d&&d[0],g=function(a){return(a+"").replace(/^-ms-/,"ms-").replace(/-([a-z]|[0-9])/gi,function(a,b){return(b+"").toUpperCase()})},h=function(a){var b=g(f+a);return a in c&&a||b in c&&b},i=function(a,b){for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c]);return a},j=function(a){for(var b=a.children||a.childNodes,c=[],d=0;d<b.length;d++)1===b[d].nodeType&&c.push(b[d]);return c},k=function(a,b){for(var c=0,d=a.length;d>c&&b.call(a[c],c,a[c])!==!1;c++);},l=function(a){a=q.fn.eventHook(a),a.preventDefault()},m=b?"touchstart":"mousedown",n=b?"touchmove":"mousemove",o=b?"touchend":"mouseup",p=d[1]||"",q=function(a,b){return this instanceof q?("string"==typeof a||a.nodeType||(b=a,a=b.id),a.nodeType||(a=document.getElementById(a)),this.cfg=i(b||{},this._default),this.element=a,this.element&&(this.container=this.element.parentNode||document.body,this.setup()),void 0):new q(a,b)};q.fn=q.prototype={_default:{id:"slider",begin:0,auto:!0,speed:600,timeout:5e3,direction:"left",align:"center",fixWidth:!0,mouseWheel:!1,before:new Function,after:new Function},css:function(a,b){var d,e,f;if("string"==typeof b)return d=document.defaultView&&document.defaultView.getComputedStyle&&getComputedStyle(a,null)||a.currentStyle||a.style||{},d[g(b)];for(e in b)f="float"==e?"cssFloat"in c?"cssFloat":"styleFloat":g(e),a.style[f]=b[e]},addListener:function(a,b,c,d){return a.addEventListener?(a.addEventListener(b,c,d),!0):a.attachEvent?(a.attachEvent("on"+b,c),!0):!1},removeListener:function(a,b,c,d){return a.addEventListener?(a.removeEventListener(b,c,d),!0):a.attachEvent?(a.detachEvent("on"+b,c),!0):!1},eventHook:function(c){var d,e,f={},g="changedTouches touches scale target view which clientX clientY fromElement offsetX offsetY pageX pageY toElement".split(" ");return c=c||a.event,k(g,function(){f[this]=c[this]}),f.target=c.target||c.srcElement||document,3===f.target.nodeType&&(f.target=f.target.parentNode),f.preventDefault=function(){c.preventDefault&&c.preventDefault(),f.returnValue=c.returnValue=!1},f.stopPropagation=function(){c.stopPropagation&&c.stopPropagation(),f.cancelBubble=c.cancelBubble=!0},b&&f.touches.length?(f.pageX=f.touches.item(0).pageX,f.pageY=f.touches.item(0).pageY):"undefined"==typeof c.pageX&&(d=document.documentElement,e=document.body,f.pageX=c.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),f.pageY=c.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),f.origEvent=c,f},bind:function(a,b){return function(){return a.apply(b,arguments)}},setup:function(){if(this.slides=j(this.element),this.length=this.slides.length,this.cfg.timeout=parseInt(this.cfg.timeout),this.cfg.speed=parseInt(this.cfg.speed),this.cfg.begin=parseInt(this.cfg.begin),this.cfg.auto=!!this.cfg.auto,this.cfg.timeout=Math.max(this.cfg.timeout,this.cfg.speed),this.touching=!!b,this.css3transition=!!d,this.index=this.cfg.begin<0||this.cfg.begin>=this.length?0:this.cfg.begin,this.length<1)return!1;switch(this.cfg.direction){case"up":case"down":this.direction=this.cfg.direction,this.vertical=1;break;case"right":this.direction="right";default:this.direction=this.direction||"left",this.vertical=0}this.addListener(this.element,m,this.bind(this._start,this),!1),this.addListener(document,n,this.bind(this._move,this),!1),this.addListener(document,o,this.bind(this._end,this),!1),this.addListener(document,"touchcancel",this.bind(this._end,this),!1),this.addListener(this.element,p,this.bind(this.transitionend,this),!1),this.addListener(a,"resize",this.bind(function(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.bind(this.resize,this),100)},this),!1),this.cfg.mouseWheel&&(this.addListener(this.element,"mousewheel",this.bind(this.mouseScroll,this),!1),this.addListener(this.element,"DOMMouseScroll",this.bind(this.mouseScroll,this),!1)),this.playing=this.cfg.auto,this.resize()},getSum:function(a,b,c){for(var d=0,e=b,f=g("-"+a);c>e;e++)d+=this["getOuter"+f](this.slides[e]);return d},getPos:function(a,b){var c=g("-"+a),d=this.getSum(a,b,b+1),e=this.getSum(a,0,b)+this["getOuter"+c](this.element)/2-this["get"+c](this.element)/2;switch(this.cfg.align){case"left":return-e;case"right":return this[a]-d-e;default:return(this[a]-d)/2-e}},resize:function(){clearTimeout(this.aniTimer);var a,b=this,c=e[this.vertical][0],d=g("-"+c),h=this.css(this.container,"position");return this.css(this.container,{overflow:"hidden",visibility:"hidden",listStyle:"none",position:"static"==h?"relative":h}),this[c]=this["get"+d](this.container),a={"float":this.vertical?"none":"left",display:"block"},k(this.slides,function(){b.cfg.fixWidth&&(a[c]=b[c]-b["margin"+d](this)-b["padding"+d](this)-b["border"+d](this)+"px"),b.css(this,a)}),this.total=this.getSum(c,0,this.length),a={position:"relative",overflow:"hidden"},a[f+"transition-duration"]="0ms",a[c]=this.total+"px",a[e[this.vertical][1]]=this.getPos(c,this.index)+"px",this.css(this.element,a),this.css(this.container,{visibility:"visible"}),this.playing&&this.play(),this},slide:function(a,b){var c,d,f,g,i,j,k,l=e[this.vertical][1],m=e[this.vertical][0],n=h("transition"),o=parseFloat(this.css(this.element,l))||0,p={},q=this.getSum(m,a,a+1);return a=Math.min(Math.max(0,a),this.length-1),b="undefined"==typeof b?this.cfg.speed:parseInt(b),c=this.getPos(m,a),d=c-o,b=Math.abs(d)<q?Math.ceil(Math.abs(d)/q*b):b,n?(p[n]=l+" ease "+b+"ms",p[l]=c+"px",this.css(this.element,p)):(f=this,g=0,i=b/10,j=function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},k=function(){i>g?(g++,f.element.style[l]=Math.ceil(j(g,o,d,i))+"px",f.aniTimer=setTimeout(k,10)):(f.element.style[l]=c+"px",f.transitionend({propertyName:l}))},clearTimeout(this.aniTimer),k()),this.cfg.before.call(this,a,this.slides[this.index]),this.index=a,this},play:function(){return clearTimeout(this.timer),this.playing=!0,this.timer=setTimeout(this.bind(function(){"left"==this.direction||"up"==this.direction?this.next():this.prev()},this),this.cfg.timeout),this},pause:function(){return clearTimeout(this.timer),this.playing=!1,this},stop:function(){return this.pause(),this.slide(0)},prev:function(a,b){clearTimeout(this.timer);var c=this.index;return a="undefined"==typeof a?a=1:a%this.length,c-=a,c=b===!1?Math.max(c,0):0>c?this.length+c:c,this.slide(c)},next:function(a,b){clearTimeout(this.timer);var c=this.index;return"undefined"==typeof a&&(a=1),c+=a,b===!1?c=Math.min(c,this.length-1):c%=this.length,this.slide(c)},_start:function(a){a=this.eventHook(a),this.touching||a.preventDefault(),this.removeListener(this.element,"click",l),this.startPos=[a.pageX,a.pageY],this.element.style[g(f+"transition-duration")]="0ms",this.startTime=+new Date,this._pos=parseFloat(this.css(this.element,e[this.vertical][1]))||0},_move:function(a){if(this.startPos&&(!a.scale||1===a.scale)){a=this.eventHook(a),this.stopPos=[a.pageX,a.pageY];var b=e[this.vertical][1],c=e[this.vertical][0],d=this.stopPos[this.vertical]-this.startPos[this.vertical];this.scrolling||"undefined"==typeof this.scrolling&&Math.abs(d)>=Math.abs(this.stopPos[1-this.vertical]-this.startPos[1-this.vertical])?(a.preventDefault(),d/=!this.index&&d>0||this.index==this.length-1&&0>d?Math.abs(d)/this[c]+1:1,this.element.style[b]=this._pos+d+"px",d&&"undefined"==typeof this.scrolling&&(this.scrolling=!0,clearTimeout(this.timer),clearTimeout(this.aniTimer))):this.scrolling=!1}},_end:function(){if(this.startPos){if(this.scrolling){var a,b,c,d=e[this.vertical][0],f=(e[this.vertical][1],this.stopPos[this.vertical]-this.startPos[this.vertical]),g=Math.abs(f),h=g/f,i=this.index,j=0;if(this.addListener(this.element,"click",l),g>20){b=parseFloat(this.css(this.element,e[this.vertical][1]));do{if(!(i>=0&&i<this.length)){i+=h;break}c=this.getPos(d,i),a=this.getSum(d,i,i+1)}while(Math.abs(c-b)>a/2&&(i-=h));j=Math.abs(i-this.index),!j&&+new Date-this.startTime<250&&(j=1)}f>0?this.prev(j,!1):this.next(j,!1),this.playing&&this.play()}delete this._pos,delete this.stopPos,delete this.startPos,delete this.scrolling,delete this.startTime}},mouseScroll:function(a){var b,c;this.cfg.mouseWheel&&(a=this.eventHook(a),a.preventDefault(),b=a.origEvent,c=b.wheelDelta||b.detail&&-1*b.detail||0,c/Math.abs(c),c>0?this.prev(1,!1):this.next(1,!1))},transitionend:function(a){a.propertyName==e[this.vertical][1]&&(this.cfg.after.call(this,this.index,this.slides[this.index]),this.playing&&this.play())}},k(["Width","Height"],function(a,b){b.toLowerCase(),k(["margin","padding","border"],function(c,d){q.fn[d+b]=function(b){return parseFloat(this.css(b,d+"-"+e[a][1]+("border"==d?"-width":"")))+parseFloat(this.css(b,d+"-"+e[a][2]+("border"==d?"-width":"")))}}),q.fn["get"+b]=function(a){return a["offset"+b]-this["padding"+b](a)-this["border"+b](a)},q.fn["getOuter"+b]=function(a){return a["offset"+b]+this["margin"+b](a)}}),a.TouchSlider=q}(window);