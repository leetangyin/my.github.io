(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55eb1096"],{"013f":function(e,t,a){var n=a("4ce5"),i=a("224c"),r=a("008a"),s=a("eafa"),o=a("5dd2");e.exports=function(e,t){var a=1==e,l=2==e,c=3==e,d=4==e,u=6==e,p=5==e||u,m=t||o;return function(t,o,f){for(var g,v,h=r(t),b=i(h),D=n(o,f,3),y=s(b.length),S=0,k=a?m(t,y):l?m(t,0):void 0;y>S;S++)if((p||S in b)&&(g=b[S],v=D(g,S,h),e))if(a)k[S]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return S;case 2:k.push(g)}else if(d)return!1;return u?-1:c||d?d:k}}},"0591":function(e,t,a){},"3b7c":function(e,t,a){"use strict";var n=a("cfb2"),i=a.n(n);i.a},"3c2d":function(e,t,a){"use strict";var n=a("0591"),i=a.n(n);i.a},"5dd2":function(e,t,a){var n=a("81dc");e.exports=function(e,t){return new(n(e))(t)}},"6c8d":function(e,t,a){"use strict";a("9e76"),a("9dd9"),a("9a33");t["a"]={getUUid:function(){for(var e=[],t="0123456789abcdef",a=0;a<36;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n},getTime:function(e){var t=new Date(e),a=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",i=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",r=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",s=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",o=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a+n+i+r+s+o},getDate:function(e){var t=new Date(e),a=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",i=t.getDate()<10?"0"+t.getDate():t.getDate();return a+n+i},ConvertLevel:function(e){return"Basic"==e?"基地":"Plant"==e?"电厂":"机组"},IsCanDisplayImage:function(e){for(var t="jpg,png,gif,bmp,icon,jpeg",a=t.split(","),n=0;n<a.length;n++)if(a[n]==e)return!0;return!1},getQueryVariable:function(e){var t=window.location.href,a=t.split("?");if(a.length>1){a=a[1].split("&");for(var n=0;n<a.length;n++){var i=a[n].split("=");if(i[0]==e)return i[1]}return null}return null},setCookie:function(e,t){var a=30,n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3),document.cookie=e+"="+escape(t)+";expires="+n.toGMTString()},getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},delCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var a=getCookie(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString())}}},"7cb9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"sidebar-container"},[a("div",{staticClass:"tree_content"},[a("el-tree",{staticStyle:{"font-size":"14px"},attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps,"highlight-current":"","expand-on-click-node":!1,"render-content":e.renderContent}})],1)]),e._v(" "),a("div",{staticClass:"main-container"},[a("div",[a("el-form",{ref:"searchForm",attrs:{model:e.searchForm}},[a("el-form-item",{attrs:{label:"姓名："}},[a("el-input",{staticClass:"el-form-item_input",attrs:{size:"small",placeholder:"请输入事件编号"},model:{value:e.searchForm.eventNo,callback:function(t){e.$set(e.searchForm,"eventNo",t)},expression:"searchForm.eventNo"}}),e._v(" "),a("span",{staticClass:"el-form-item_titel my_el-form-item_tite"},[e._v("事件描述：")]),e._v(" "),a("el-input",{staticClass:"el-form-item_input",attrs:{size:"small",placeholder:"请输入事件描述"},model:{value:e.searchForm.eventNo,callback:function(t){e.$set(e.searchForm,"eventNo",t)},expression:"searchForm.eventNo"}}),e._v(" "),a("span",{staticClass:"el-form-item_titel my_el-form-item_tite"},[e._v("事件原因：")]),e._v(" "),a("el-input",{staticClass:"el-form-item_input",attrs:{size:"small",placeholder:"请输入事件原因"},model:{value:e.searchForm.eventReason,callback:function(t){e.$set(e.searchForm,"eventReason",t)},expression:"searchForm.eventReason"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:function(t){return e.getDataList("check")}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetGetDataList()}}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{height:"calc(100vh - 150px)"},attrs:{id:"table_content"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"font-size":"12px"},attrs:{data:e.tableData,border:"",height:e.tableHeader}},[a("el-table-column",{attrs:{prop:"repairSequenceName",label:"大修轮次",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rangeName",label:"发现区域",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventNo",label:"事件编号",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventDesc",label:"事件描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventReason",label:"事件原因"}}),e._v(" "),a("el-table-column",{attrs:{prop:"funcCode",label:"功能位置",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventPerson",label:"关联人",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"发现时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.discoverDatetime?a("span",[e._v(e._s(e.timestampToTime(t.row.discoverDatetime)))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})]}}])},[a("template",{slot:"header"},[a("span",[e._v("\n              操作\n              "),a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#409eff","margin-left":"3px","font-size":"17px",cursor:"pointer",top:"2px",position:"relative"},on:{click:e.addListClick}})])])],2)],1),e._v(" "),a("div",{staticClass:"my_el_pagination"},[a("el-pagination",{attrs:{"page-sizes":[20,50,100],"page-size":e.size,"current-page":e.PageIndex,layout:"prev, pager, next, jumper,sizes,total",total:e.total},on:{"update:currentPage":function(t){e.PageIndex=t},"update:current-page":function(t){e.PageIndex=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("AddPage",{ref:"addpage",on:{getDataList:e.getDataList,addClick:e.addClick}})],1)},i=[],r=a("a336"),s=a.n(r),o=a("b775"),l=a("7c15"),c=(a("6c8d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{attrs:{id:"ywsj"}},[a("el-dialog",{attrs:{title:e.titel,visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"addForm",attrs:{inline:!0,model:e.addForm,rules:e.rules,"label-position":e.labelPosition}},[a("el-form-item",{attrs:{label:"基地",prop:"base","label-width":"100px"}},[a("el-select",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请选择基地"},on:{change:e.getStataionData},model:{value:e.addForm.base,callback:function(t){e.$set(e.addForm,"base",t)},expression:"addForm.base"}},e._l(e.companyData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"电站",prop:"plant","label-width":"100px"}},[a("el-select",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请选择电站"},on:{change:e.getRepairSequenceData},model:{value:e.addForm.plant,callback:function(t){e.$set(e.addForm,"plant",t)},expression:"addForm.plant"}},e._l(e.stataionData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"大修轮次",prop:"repairSequenceId","label-width":"100px"}},[a("el-select",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请选择大修轮次"},on:{change:e.getRangeData},model:{value:e.addForm.repairSequenceId,callback:function(t){e.$set(e.addForm,"repairSequenceId",t)},expression:"addForm.repairSequenceId"}},e._l(e.sequenceData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"工作区域",prop:"repairWorkRangeManagerId","label-width":"100px",required:!0}},[a("el-select",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small"},on:{change:e.getIsDeviationInfo},model:{value:e.addForm.repairWorkRangeManagerId,callback:function(t){e.$set(e.addForm,"repairWorkRangeManagerId",t)},expression:"addForm.repairWorkRangeManagerId"}},e._l(e.rangeData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"事件编号",prop:"eventNo","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请输入事件编号"},model:{value:e.addForm.eventNo,callback:function(t){e.$set(e.addForm,"eventNo",t)},expression:"addForm.eventNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发现时间",prop:"discoverDatetime","label-width":"100px"}},[a("el-date-picker",{staticStyle:{width:"176px"},attrs:{size:"small",type:"datetime",placeholder:"请选择发现时间"},model:{value:e.addForm.discoverDatetime,callback:function(t){e.$set(e.addForm,"discoverDatetime",t)},expression:"addForm.discoverDatetime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"事件描述",prop:"eventDesc","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"477px"},attrs:{type:"textarea",size:"small",placeholder:"请输入事件描述"},model:{value:e.addForm.eventDesc,callback:function(t){e.$set(e.addForm,"eventDesc",t)},expression:"addForm.eventDesc"}})],1),e._v(" "),a("el-form-item",{ref:"eventPersons",attrs:{label:"关联人员","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"477px"},attrs:{size:"small",placeholder:"请选择关联人员"},nativeOn:{click:function(t){return e.staffSelectClick(1)}},model:{value:e.addForm.eventPerson,callback:function(t){e.$set(e.addForm,"eventPerson",t)},expression:"addForm.eventPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行专业编码","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请输入执行专业编码"},model:{value:e.addForm.specialityCode,callback:function(t){e.$set(e.addForm,"specialityCode",t)},expression:"addForm.specialityCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行专业名称","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"176px"},attrs:{size:"small",placeholder:"请输入执行专业名称"},model:{value:e.addForm.specialityName,callback:function(t){e.$set(e.addForm,"specialityName",t)},expression:"addForm.specialityName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关联物品","label-width":"100px"}},[a("el-select",{staticClass:"el-form-item_input",staticStyle:{width:"477px"},attrs:{size:"small",multiple:"",placeholder:"请选择关联物品"},model:{value:e.componentUerDetailsIds,callback:function(t){e.componentUerDetailsIds=t},expression:"componentUerDetailsIds"}},e._l(e.componentUerDetails,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"--"+e.usePerson,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能位置","label-width":"100px"}},[a("el-input",{staticClass:"el-form-item_input",staticStyle:{width:"477px"},attrs:{size:"small",placeholder:"请输入功能位置"},model:{value:e.addForm.funcCode,callback:function(t){e.$set(e.addForm,"funcCode",t)},expression:"addForm.funcCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果","label-width":"100px"}},[a("el-input",{staticStyle:{width:"477px"},attrs:{type:"textarea",placeholder:"请输入处理结果"},model:{value:e.addForm.processResult,callback:function(t){e.$set(e.addForm,"processResult",t)},expression:"addForm.processResult"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"事件原因",prop:"eventReason","label-width":"100px"}},[a("el-input",{staticStyle:{width:"477px"},attrs:{type:"textarea",placeholder:"请输入事件原因"},model:{value:e.addForm.eventReason,callback:function(t){e.$set(e.addForm,"eventReason",t)},expression:"addForm.eventReason"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[a("el-input",{staticStyle:{width:"477px"},attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addClick}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("StaffSelect",{ref:"staffSelect",on:{addStaffClick:e.addStaffClick}})],1)}),d=[],u=(a("9a33"),a("9805")),p={watch:{dialogVisible:function(e){var t=this;if(e){var a=s()(window).height()-70;t.$nextTick((function(){s()("#ywsj .el-dialog").css("width","700px"),s()("#ywsj .el-dialog").css("max-height",a-10+"px"),s()("#ywsj .el-dialog__body").css("max-height",a-150+"px"),s()("#ywsj .el-dialog").css("margin-top","60px"),s()("#ywsj .el-dialog__body").css("overflow-y","auto")}))}else t.addForm={base:"",plant:"",remark:"",createdBy:"",id:"",eventNo:"",eventDesc:"",repairSequenceId:"",eventReason:"",discoverDatetime:"",repairWorkRangeManagerId:"",companyStationRangeId:"",specialityCode:"",specialityName:"",discoverPerson:"",funcCode:"",componentUerDetails:"",eventPerson:"",processResult:""},t.stataionData=[],t.sequenceData=[],t.companyData=[],t.rangeData=[],t.componentUerDetailsIds=[],t.componentUerDetails=[],t.$refs["addForm"].resetFields()}},data:function(){return{stataionData:[],sequenceData:[],rangeData:[],dialogVisible:!1,titel:"异物事件管理",labelPosition:"right",companyData:[],selectedType:"",rules:{base:[{required:!0,message:"请选择基地",trigger:"blur"}],plant:[{required:!0,message:"请选择电站",trigger:"blur"}],discoverDatetime:[{required:!0,message:"请选择发现日期",trigger:"blur"}],eventNo:[{required:!0,message:"请输入事件编号",trigger:"blur"}],eventDesc:[{required:!0,message:"请输入事件描述",trigger:"blur"}],eventReason:[{required:!0,message:"请输入事件原因",trigger:"blur"}],repairSequenceId:[{required:!0,message:"请选择大修轮次",trigger:"blur"}],repairWorkRangeManagerId:[{required:!0,message:"请选择工作区域",trigger:"blur"}]},addForm:{base:"",plant:"",eventNo:"",eventDesc:"",eventReason:"",remark:"",createdBy:"",id:"",discoverDatetime:"",funcCode:"",repairSequenceId:"",componentUerDetails:"",repairWorkRangeManagerId:"",specialityCode:"",specialityName:"",processResult:"",discoverPerson:"",companyStationRangeId:""},componentUerDetailsIds:[],componentUerDetails:[]}},components:{StaffSelect:u["a"]},mounted:function(){this},methods:{addStaffClick:function(e){var t=this;if(e.length>0){var a=[];for(var n in e){var i=e[n];a.push(i.displayName)}t.addForm.eventPerson=a.join(","),t.$refs["eventPersons"].clearValidate(),t.$forceUpdate()}else t.addForm.eventPerson="";t.$refs["staffSelect"].closeClick()},staffSelectClick:function(e){var t=this;t.selectedType=e,t.$refs["staffSelect"].init({deptNos:"",selectedUser:0==e?t.addForm.discoverPerson:t.addForm.eventPerson},"1")},addClick:function(){var e=this;this.$refs["addForm"].validate((function(t){if(t){for(var a in e.rangeData)e.rangeData[a].id==e.addForm.repairWorkRangeManagerId&&(e.addForm.companyStationRangeId=e.rangeData[a].companyStationRangeId);e.componentUerDetailsIds.length>0&&(e.addForm.componentUerDetails=e.componentUerDetailsIds.join(",")),e.$emit("addClick",e.addForm)}else;}))},closeClick:function(){var e=this;e.dialogVisible=!1},getCompanyData:function(){var e=this;Object(o["a"])({url:l["a"].getStationUnitInfo,method:"get",params:{parent:"0",unitlevel:"Basic"}}).then((function(t){e.companyData=t.result}))},getIsDeviationInfo:function(){var e=this;Object(o["a"])({url:l["a"].getIsDeviationInfo,method:"post",data:{repairSequenceId:e.addForm.repairSequenceId,repairWorkRangeManagerId:e.addForm.repairWorkRangeManagerId}}).then((function(t){e.componentUerDetails=t.result}))},getStataionData:function(e){var t=this;t.addForm.base=e,Object(o["a"])({url:l["a"].getStationUnitInfo,method:"get",params:{parent:t.addForm.base,unitlevel:"Plant"}}).then((function(e){200==e.code?t.stataionData=e.result:t.$message({type:"info",message:e.message})}))},getRepairSequenceData:function(e){var t=this;Object(o["a"])({url:l["a"].getRepairSequenceInfo,method:"get",params:{companyId:e,subId:0}}).then((function(e){t.sequenceData=e.result}))},getRangeData:function(e){var t=this;Object(o["a"])({url:l["a"].getRepairSequenceInfo,method:"get",params:{companyId:e,subId:1}}).then((function(e){200==e.code?t.rangeData=e.result:t.$message({type:"info",message:e.message})}))},init:function(e,t){var a=this;this,a.dialogVisible=!0,a.getCompanyData(),t?(a.addForm=e,e.componentUerDetails&&(a.addForm.componentUerDetails=e.componentUerDetails,a.componentUerDetailsIds=e.componentUerDetails.split(",")),a.getStataionData(e.base),a.getRepairSequenceData(e.plant),a.getRangeData(e.repairSequenceId),a.getIsDeviationInfo()):(a.addForm.createdBy=e.createdBy,a.addForm.id=e.id,""!=e.base&&(a.addForm.base=e.base,a.getStataionData(a.addForm.base),""!=e.plant&&(a.addForm.plant=e.plant,a.getRepairSequenceData(e.plant),""!=e.sequenceId&&(a.addForm.repairSequenceId=e.repairSequenceId,a.getRangeData(e.repairSequenceId),""!=e.repairWorkRangeManagerId&&(a.addForm.repairWorkRangeManagerId=e.repairWorkRangeManagerId,a.getIsDeviationInfo(),e.componentUerDetails&&(a.addForm.componentUerDetails=e.componentUerDetails,a.componentUerDetailsIds=e.componentUerDetails.split(",")))))))}}},m=p,f=a("9ca4"),g=Object(f["a"])(m,c,d,!1,null,null,null),v=g.exports,h={name:"index",data:function(){return{loading:!1,PageIndex:1,tableHeader:0,labelPosition:"right",dialogVisible:!1,size:50,total:1,tableData:[],searchForm:{base:"",plant:"",repairWorkRangeManagerId:"",repairSequenceId:"",eventNo:"",eventReason:"",eventDesc:""},defaultProps:{children:"children",label:"name",code:"code",id:"id"},treeData:[]}},mounted:function(){var e=this;e.getDataTreeList(),e.getDataList(),e.setHeight(),s()(window).resize((function(){e.setHeight()}))},components:{AddPage:v},methods:{addListClick:function(){var e=this;e.postType="add",e.$refs["addpage"].init({base:e.searchForm.base,plant:e.searchForm.plant,repairSequenceId:e.searchForm.repairSequenceId,repairWorkRangeManagerId:e.searchForm.repairWorkRangeManagerId,createdBy:JSON.parse(sessionStorage.userInfo)["displayName"]},!1)},addClick:function(e){var t=this,a=l["a"].saveFmeEventManager,n={base:e.base,plant:e.plant,remark:e.remark,id:e.id,eventNo:e.eventNo,repairSequenceId:e.repairSequenceId,eventDesc:e.eventDesc,eventReason:e.eventReason,repairWorkRangeManagerId:e.repairWorkRangeManagerId,companyStationRangeId:e.companyStationRangeId,specialityCode:e.specialityCode,specialityName:e.specialityName,funcCode:e.funcCode,componentUerDetails:e.componentUerDetails,eventPerson:e.eventPerson,processResult:e.processResult,discoverPerson:e.discoverPerson};""!=e.discoverDatetime&&(n.discoverDatetime=new Date(e.discoverDatetime).getTime()),Object(o["a"])({url:a,method:"post",data:n}).then((function(e){200==e.code&&(t.$message({type:"success",message:"操作成功!"}),t.$refs["addpage"].closeClick(),t.getDataList())}))},setHeight:function(){var e=this;e.$nextTick((function(){var t=document.getElementById("table_content"),a=t.offsetHeight;e.tableHeader=a-60}))},handleEdit:function(e,t){var a=this;a.postType="edit",a.$refs["addpage"].init(t,!0)},handleDelete:function(e,t){var a=this;this.$confirm("您确定要删除该信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["a"])({url:l["a"].deleteFmeEventManager,method:"post",data:{id:t.id}}).then((function(e){200==e.code?(a.$message({type:"success",message:"删除成功!"}),a.getDataList()):a.$message({type:"info",message:e.message})}))})).catch((function(){}))},resetGetDataList:function(){var e=this;e.searchForm.base="",e.searchForm.plant="",e.searchForm.repairSequenceId="",e.searchForm.repairWorkRangeManagerId="",e.searchForm.eventNo="",e.searchForm.eventReason="",e.searchForm.eventDesc="",e.PageIndex=1,e.getDataList()},getDataList:function(e){var t=this;t.loading=!0,"check"==e&&(t.PageIndex=1);var a=t.searchForm;a.PageSize=t.size,a.PageIndex=t.PageIndex,Object(o["a"])({url:l["a"].getFmeEventManagerInfo,method:"post",data:a}).then((function(e){var a=e.result.rows;t.loading=!1,t.tableData=a,t.total=parseInt(e.result.records)}))},timestampToTime:function(e){var t="";if(e){var a=new Date(e),n=a.getFullYear()+"-",i=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",r=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",s=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",o=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",l=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();t=n+i+r+s+o+l}else t="";return t},renderContent:function(e,t){var a=this,n=t.node,i=t.data;t.store;return"全部"==n.label?e("span",{class:"custom-tree-node"},[e("span",[n.label])]):("null"!=JSON.stringify(i.children)&&""!=JSON.stringify(i.children)&&void 0!=JSON.stringify(i.children)&&JSON.stringify(i.children),e("span",{class:"custom-tree-node"},[e("span",{on:{click:function(){return a.onClickTree(i,n)}}},[n.label])]))},onClickTree:function(e,t){var a=this;1==t.level?(a.searchForm.base=e.id,a.searchForm.plant="",a.searchForm.repairSequenceId="",a.searchForm.repairWorkRangeManagerId=""):2==t.level?(a.searchForm.base=e.attribute.companyId,a.searchForm.plant=e.id,a.searchForm.repairSequenceId="",a.searchForm.repairWorkRangeManagerId=""):3==t.level?(a.searchForm.base=e.attribute.subParentId,a.searchForm.plant=e.attribute.companyId,a.searchForm.repairSequenceId=e.id,a.searchForm.repairWorkRangeManagerId=""):(a.searchForm.base=e.attribute.subParentId,a.searchForm.plant=e.attribute.subId,a.searchForm.repairSequenceId=e.attribute.companyId,a.searchForm.repairWorkRangeManagerId=e.id),a.getDataList()},getDataTreeList:function(){var e=this;Object(o["a"])({url:l["a"].getWorkRangeInfo,method:"get"}).then((function(t){e.treeData=t.result,e.$nextTick((function(){s()(".el-tree-node.is-expanded").removeClass("el-tree-node__children")}))}))},handleSizeChange:function(e){},handleCurrentChange:function(e){var t=this;t.PageIndex=e,t.getDataList()}}},b=h,D=(a("3c2d"),Object(f["a"])(b,n,i,!1,null,"6718e380",null));t["default"]=D.exports},"81dc":function(e,t,a){var n=a("fb68"),i=a("2346"),r=a("cb3d")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&(t=t[r],null===t&&(t=void 0))),void 0===t?Array:t}},9805:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bodyStaff",attrs:{id:"bodyStaffOne"}},[a("el-dialog",{attrs:{title:e.titel,visible:e.dialogStaffVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogStaffVisible=t}}},[a("div",{staticClass:"bp-alert bp-alert-info",staticStyle:{"margin-top":"10x"},attrs:{id:"alert"}},[a("strong",[e._v("提示：")]),e._v("关键字至少2个字，双击选中或取消。\n      ")]),e._v(" "),a("table",{attrs:{id:"tab"}},[a("tr",[a("td",[a("el-input",{ref:"editTagFoucus",staticStyle:{width:"200px"},attrs:{size:"mini"},on:{blur:function(t){return e.keywordChange()}},nativeOn:{keyup:function(t){return e.keywordChange()}},model:{value:e.staffName,callback:function(t){e.staffName=t},expression:"staffName"}}),e._v(" "),a("a",{staticClass:"bp-linkbtn",attrs:{id:"menuBtn",href:"#"},on:{click:function(t){return e.showDept(),!1}}},[e._v("部门")])],1),e._v(" "),a("td",{attrs:{rowspan:"2",id:"td2"}},[a("div",[a("el-button",{attrs:{type:"primary",title:"添加全部",size:"small",id:"addAll",icon:"el-icon-d-arrow-right"},on:{click:function(t){return e.allStaff()}}})],1),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",title:"移除选中项",size:"small",icon:"el-icon-arrow-right"},on:{click:function(t){return e.selectSingle()}}})],1),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",title:"移除选中项",size:"small",icon:"el-icon-arrow-left"},on:{click:function(t){return e.removeSingle()}}})],1),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",title:"移除全部",size:"small",icon:"el-icon-d-arrow-left"},on:{click:function(t){return e.removeStaff()}}})],1)]),e._v(" "),a("td",[a("span",[e._v("已选人员："+e._s(e.selectCount))])])]),e._v(" "),a("tr",[a("td",[a("select",{attrs:{id:"selecting",name:"selecting",multiple:"multiple"},on:{dblclick:function(t){return e.selectSingle(1)},click:e.showDeptName}},e._l(e.selectingData,(function(t){return a("option",{key:t.id,attrs:{"data-value":t},domProps:{value:t.id}},[e._v("\n                "+e._s(t.displayName)+"\n              ")])})),0)]),e._v(" "),a("td",{staticStyle:{"padding-top":"10px"}},[a("select",{attrs:{id:"selected",name:"selected",multiple:"multiple"},on:{dblclick:function(t){return e.removeSingle()}}},e._l(e.selectData,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v("\n                "+e._s(t.displayName)+"\n              ")])})),0)])])]),e._v(" "),a("p",{staticStyle:{"margin-bottom":"0px"},attrs:{id:"deptInfo"}},[a("strong",[e._v("所属部门："+e._s(e.currentDept))]),e._v(" "),a("span")]),e._v(" "),a("div",{staticClass:"menuContent bp-borderColor",attrs:{id:"menuContent"}},[a("el-tree",{ref:"tree",staticClass:"ztree",staticStyle:{"font-size":"14px"},attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"node",on:{dblclick:function(t){return e.dblclickNode(n,i)}}},[e._v(e._s(n.label))])])}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogStaffVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addStaffClick}},[e._v("确 定")])],1)])],1)},i=[],r=(a("e697"),a("2b45"),a("9a33"),a("52c1"),a("b775")),s=a("7c15"),o=(a("6c8d"),a("a336")),l=a.n(o),c={name:"StaffSelect",watch:{dialogStaffVisible:function(e){var t=this;e?t.$nextTick((function(){var e=l()(window).height()-70;t.$nextTick((function(){l()("#bodyStaffOne .el-dialog").css("width","640px"),l()("#bodyStaffOne .el-dialog").css("margin-top","60px"),l()("#bodyStaffOne .el-dialog").css("max-height",e-10+"px"),l()("#bodyStaffOne .el-dialog").css("overflow","hidden"),l()("#bodyStaffOne .el-dialog__body").css("overflow-y","auto")}))})):(t.staffName="",t.keyUpName="",t.currentDept="",t.currentUser="",t.selectData=[],t.deptNos="",t.selectingData=[],t.selectCount=0,t.treeData=[])}},data:function(){return{isMultiple:"",dialogStaffVisible:!1,selectCount:0,selectData:[],currentUser:"",currentDept:"",queryTimeout:"",selectingData:[],deptNos:"",staffName:"",keyUpName:"",deptNoPath:"",defaultProps:{children:"children",label:"name",id:"id"},titel:"人员选择",treeData:[]}},mounted:function(){},methods:{addStaffClick:function(){var e=this;e.$emit("addStaffClick",e.selectData)},dblclickNode:function(e,t){var a=this;a.staffName=t.attribute.deptName,a.deptNoPath=t.attribute.deptNoPath,a.queryStaff(2),a.hideDept()},loadStaffs:function(){var e=this;if(null!=e.currentUser&&e.currentUser.length>0){for(var t=e.currentUser.toString().split(","),a=new Array,n=0;n<t.length;n++)t[n].length>0&&(t[n].indexOf("[")>0?a.push(t[n].split("[")[1].slice(0,-1)):a.push(t[n]));if(a.length>0){var i=s["a"].getStaffInfoByStaffIdsInfo,o={staffIDs:a.join(",")};Object(r["a"])({url:i,method:"get",params:o}).then((function(t){e.selectData=t.result,e.selectCount=e.selectData.length}))}}},showDeptName:function(){var e=this,t=l()("#selecting").find("option:selected"),a=t.val();for(var n in e.selectingData)e.selectingData[n].id==a&&(e.currentDept=e.selectingData[n].deptNamePath)},handleNodeClick:function(e){},hideDept:function(){var e=this;l()("#menuContent").fadeOut("fast"),l()(".bodyStaff").unbind("mousedown",e.onBodyDown)},showDept:function(){var e=this,t=l()("#keyword");t.offset();l()("#menuContent").css({left:"24px",top:"140px"}).slideDown("fast"),l()(".bodyStaff").bind("mousedown",e.onBodyDown)},onBodyDown:function(e){var t=this;"menuBtn"==e.target.id||"menuContent"==e.target.id||l()(e.target).parents("#menuContent").length>0||t.hideDept()},selectSingle:function(e){var t=this,a=l()("#selecting").find("option:selected"),n=a.val();for(var i in"0"==t.isMultiple&&t.selectData.length>0&&(t.selectingData.push(t.selectData[0]),t.selectData=[]),t.selectingData){var r=t.selectingData[i];r.id==n&&(t.selectData.push(r),t.selectingData.splice(l.a.inArray(r,t.selectingData),1))}t.selectCount=t.selectData.length,"0"==t.isMultiple&&1==e&&t.addStaffClick()},removeStaff:function(){var e=this;if(null!=e.selectData&&e.selectData.length>0){for(var t in e.selectData)e.selectingData.push(e.selectData[t]);e.selectData=[]}e.selectCount=0},allStaff:function(){var e=this;if("0"!=e.isMultiple){if(null!=e.selectingData&&e.selectingData.length>0){for(var t in e.selectingData)e.selectData.push(e.selectingData[t]);e.selectingData=[]}e.selectCount=e.selectData.length}},removeSingle:function(){var e=this,t=l()("#selected").find("option:selected"),a=t.val();if(null!=a&&null!=e.selectData&&e.selectData.length>0)for(var n in e.selectData){var i=e.selectData[n];i.id==a&&(e.selectingData.push(i),e.selectData.splice(l.a.inArray(i,e.selectData),1))}e.selectCount=e.selectData.length},keywordChange:function(){var e=this;e.staffName.length>1&&e.staffName!=e.keyUpName?(e.queryTimeout&&clearTimeout(e.queryTimeout),e.queryTimeout=setTimeout((function(){e.queryStaff(1)}),500)):e.staffName.length<2&&(e.queryTimeout&&clearTimeout(e.queryTimeout),e.selectingData=[]),e.keyUpName=e.staffName},queryStaff:function(e){var t=this,a=s["a"].getStaffInfosByName,n={staffName:t.staffName};2==e&&(a=s["a"].getStaffInfosByDepartNoPath,n={deptNoPath:t.deptNoPath}),Object(r["a"])({url:a,method:"get",params:n}).then((function(e){if(t.selectingData=e.result,t.selectData.length>0)for(var a in t.selectData)for(var n in t.selectingData)t.selectData[a].id==t.selectingData[n].id&&t.selectingData.splice(l.a.inArray(t.selectingData[n],t.selectingData),1)}))},initDept:function(){var e=this;Object(r["a"])({url:s["a"].getAllDepartmentInfos,method:"get",params:{depNos:e.deptNos}}).then((function(t){e.treeData=t.result}))},closeClick:function(){var e=this;e.dialogStaffVisible=!1},init:function(e,t){var a=this;a.staffName=JSON.parse(sessionStorage.userInfo)["departmentName"],a.keyUpName=JSON.parse(sessionStorage.userInfo)["departmentName"],a.deptNoPath=JSON.parse(sessionStorage.userInfo)["departmentNoPath"],a.dialogStaffVisible=!0,a.isMultiple=t,a.hideDept(),null!=e&&(null!=e.deptNos&&e.deptNos.length>0&&(a.deptNos=e.deptNos.spilt(",")),null!=e.selectedUser&&(a.currentUser=e.selectedUser)),"0"==a.isMultiple?a.titel="单选人员选择":a.titel="多选人员选择",a.initDept(),a.loadStaffs(),setTimeout((function(){a.queryStaff(2)}),200)}}},d=c,u=(a("3b7c"),a("9ca4")),p=Object(u["a"])(d,n,i,!1,null,"6c6c6327",null);t["a"]=p.exports},"9e76":function(e,t,a){"use strict";var n=a("69b3"),i=a("eafa"),r=a("e754"),s=a("7108");a("0aed")("match",1,(function(e,t,a,o){return[function(a){var n=e(this),i=void 0==a?void 0:a[t];return void 0!==i?i.call(a,n):new RegExp(a)[t](String(n))},function(e){var t=o(a,e,this);if(t.done)return t.value;var l=n(e),c=String(this);if(!l.global)return s(l,c);var d=l.unicode;l.lastIndex=0;var u,p=[],m=0;while(null!==(u=s(l,c))){var f=String(u[0]);p[m]=f,""===f&&(l.lastIndex=r(c,i(l.lastIndex),d)),m++}return 0===m?null:p}]}))},cfb2:function(e,t,a){},e697:function(e,t,a){"use strict";var n=a("e46b"),i=a("013f")(5),r="find",s=!0;r in[]&&Array(1)[r]((function(){s=!1})),n(n.P+n.F*s,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("0e8b")(r)}}]);